// ============================================================================
// Add resources and processes to the KerbalismSupport profile
// ============================================================================
Profile
{
	name = KerbalismSupport
	modname = Near Future Electrical
	moddir = NearFutureElectrical

	Supply
	{
		resource = Uraninite
		low_message = Uraninite is almost depleted on $VESSEL@<i>Enriched Uranium production will soon be unavailable</i>
		empty_message = There is no more Uraninite on $VESSEL@<i>Enriched Uranium production is no longer available</i>
		refill_message = $VESSEL Uraninite storage refilled@<i>Enriched Uranium production is available</i>
	}

	Supply
	{
		resource = EnrichedUranium
		low_message = Enriched Uranium is almost depleted on $VESSEL@<i>Nuclear Reactors will shut down soon</i>
		empty_message = There is no more Enriched Uranium on $VESSEL@<i>Nuclear Reactors have shut down</i>
		refill_message = $VESSEL Enriched Uranium storage refilled@<i>Nuclear Reactors back online</i>
	}
}

B9_TANK_TYPE:NEEDS[B9PartSwitch]
{
        name = Uraninite
        tankMass =  0.00010627500
        tankCost = 0.15

        RESOURCE
        {
                name = Uraninite
                unitsPerVolume = 1
        }
}

// ============================================================================
// Add Uraninite ore to inline containers
// ============================================================================
@PART[kerbalism-container-inline-*]:HAS[@MODULE[Configure]:HAS[!SETUP[Uraninite]]]:NEEDS[NearFutureElectrical,ProfileDefault]:AFTER[NearFutureElectrical]
{
	@MODULE[Configure]:NEEDS[!B9PartSwitch]
	{
		SETUP
		{
			name = Uraninite
			desc = Store <b>Uraninite</b> ore.
			tech = advScienceTech

			RESOURCE
			{
				name = Uraninite
				amount = 1
				maxAmount = 1
				@amount *= #$/ContainerVolume$
				@maxAmount *= #$/ContainerVolume$
			}
		}
	}

	@MODULE[ModuleB9PartSwitch]:NEEDS[B9PartSwitch]
	{
		SUBTYPE
		{
			name = Uraninite
			title = Uraninite
			tankType = Uraninite
		}
	}
}

// ============================================================================
// Add Uraninite drilling to ISRU drills
// ============================================================================
@PART[MiniDrill,RadialDrill]:HAS[@MODULE[Harvester]:HAS[~title[Uraninite?Extraction]]]:NEEDS[NearFutureElectrical,ProfileDefault]:AFTER[NearFutureElectrical]
{
	MODULE
	{
		name = Harvester
		title = Uraninite Extraction
		drill = ImpactTransform
		type = 0
		resource = Uraninite
		min_abundance = 0.05
		rate = 0.0002746
		ec_rate = 1.0
	}

	@MODULE[Configure]
	{
		SETUP
		{
			name = Uraninite Extraction
			desc = Extract <b>Uraninite</b> from the surface.

			MODULE
			{
				type = Harvester
				id_field = resource
				id_value = Uraninite
			}

			RESOURCE
			{
				name = Uraninite
				amount = 0
				maxAmount = 50
			}
		}
	}
}
@PART[RadialDrill]:NEEDS[NearFutureElectrical,ProfileDefault]:AFTER[NearFutureElectrical]
{
	@MODULE[Harvester]:HAS[#title[Uraninite*]]
	{
		@rate = 0.001373
		@ec_rate = 5.0
	}
}

@PART[MiniDrill]:NEEDS[NearFutureElectrical,ProfileDefault]:AFTER[NearFutureElectrical]
{
	@MODULE[ModuleAsteroidDrill]
	{
		@PowerConsumption = 1.27
	}
}

// ============================================================================
// Pseudo-resources used by Kerbalism support for NearFutureElectrical
// ============================================================================
RESOURCE_DEFINITION:NEEDS[NearFutureElectrical,ProfileDefault]
{
	name = _Centrifuge
	density = 0.0
	isVisible = false
}

RESOURCE_DEFINITION:NEEDS[NearFutureElectrical,ProfileDefault]
{
	name = _Breeder
	density = 0.0
	isVisible = false
}

RESOURCE_DEFINITION:NEEDS[NearFutureElectrical,ProfileDefault]
{
	name = _Nukereactor
	density = 0.0
	isVisible = false
}

@RESOURCE_DEFINITION[DepletedFuel]:NEEDS[NearFutureElectrical,ProfileDefault]:AFTER[NearFutureElectrical]
{
	@isTweakable = true
}
